<div class="files-container">
  <div class="volver-atras">
    <a [routerLink]="['/dashboard/projects', projectId]" class="btn-volver">
      <i class="fa-solid fa-arrow-left"></i> Volver al proyecto
    </a>
  </div>

  <div class="upload-section">
    <div class="dropzone"
       (click)="fileInput.click()"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)"
       [class.active]="isDragging">
       
      <ng-container *ngIf="!selectedFile">
        <i class="fa-solid fa-cloud-arrow-up"></i>
        <p>Haz clic o arrastra un archivo para subirlo</p>
      </ng-container>

      <ng-container *ngIf="selectedFile">
        <i class="fa-solid fa-file"></i>
        <p>{{ selectedFile.name }}</p>
        <button class="upload-btn" (click)="upload(); $event.stopPropagation()"><i class="fa-solid fa-cloud-arrow-up"></i> Subir</button>
      </ng-container>

      <input #fileInput type="file" name="file" hidden (change)="onFileSelected($event)">
    </div>
  </div>
  

  <div *ngIf="files.length === 0">No hay archivos subidos a√∫n.</div>

  <ul class="file-list">
    <li *ngFor="let file of files">
      <div class="file-name" title="{{ file.original_name }}">
        {{ file.original_name }}
      </div>
      <div class="file-size">
        {{ (file.size / 1024).toFixed(2) }} KB
      </div>
      <!-- Desktop actions -->
      <div class="file-actions desktop">
        <button (click)="preview(file)"><i class="fa-solid fa-expand"></i></button>
        <button (click)="download(file.id, file.original_name)"><i class="fa-solid fa-cloud-arrow-down"></i></button>
        <button (click)="delete(file.id)"><i class="fa-solid fa-trash"></i></button>
      </div>

      <!-- Mobile dropdown -->
      <div class="file-actions mobile">
        <button (click)="toggleDropdown(file)">
          <i class="fa-solid fa-ellipsis-vertical"></i>
        </button>
        <div class="dropdown-menu" *ngIf="file.dropdownOpen">
          <button (click)="preview(file); file.dropdownOpen = false"><i class="fa-solid fa-expand"></i></button>
          <button (click)="download(file.id, file.original_name); file.dropdownOpen = false"><i class="fa-solid fa-cloud-arrow-down"></i></button>
          <button (click)="delete(file.id); file.dropdownOpen = false"><i class="fa-solid fa-trash"></i></button>
        </div>
      </div>
    </li>
  </ul>
</div>


